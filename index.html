<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swedish-English Vocabulary Game</title>
    <style>
        /* CSS */
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Lexend', sans-serif;
        }

        body {
            background: #f7f7ff;
            padding: 10px;
            font-size: 16px;
            line-height: 1.5;
        }

        h1 {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* Input Screen */
        #input-screen {
            max-width: 600px;
            margin: 0 auto;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }

        .grid input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            min-height: 48px;
        }

        .grid .row-num {
            font-size: 14px;
            text-align: center;
            padding: 8px;
        }

        #more-rows {
            text-align: center;
            color: #888;
        }

        .buttons {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background: #aaffaa;
            cursor: pointer;
            min-height: 48px;
        }

        button:hover {
            background: #88ee88;
        }

        #error-msg {
            color: #ffaaaa;
            text-align: center;
            margin-top: 5px;
        }

        /* Game Screen */
        #game-screen {
            max-width: 600px;
            margin: 0 auto;
        }

        #progress {
            text-align: center;
            margin-bottom: 10px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .card {
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            min-height: 48px;
            transition: all 0.3s;
        }

        .card.selected {
            transform: scale(1.1);
            border-color: #88ee88;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .card.correct {
            background: #aaffaa;
        }

        .card.incorrect {
            background: #ffaaaa;
        }

        /* Results Screen */
        #results-screen {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        #stats {
            margin: 20px 0;
        }

        /* Mobile Adjustments */
        @media (max-width: 400px) {
            .grid, .game-grid {
                grid-template-columns: 1fr;
            }
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- HTML -->
    <div id="input-screen" class="screen active">
        <h1>Enter Swedish-English Vocabulary</h1>
        <div id="input-grid" class="grid"></div>
        <div id="more-rows">(...)</div>
        <select id="presets">
            <option value="">Select Preset List</option>
            <option value="beginner">Beginner</option>
            <option value="intermediate">Intermediate</option>
        </select>
        <div class="buttons">
            <button onclick="addRow()">Add Row</button>
            <button onclick="loadSavedList()">Load Saved</button>
            <button onclick="exportList()">Export List</button>
            <button onclick="startGame()">Start Game</button>
        </div>
        <div id="error-msg"></div>
    </div>

    <div id="game-screen" class="screen">
        <h1>Match the Words</h1>
        <div id="progress"></div>
        <div id="game-grid" class="game-grid"></div>
        <div class="buttons">
            <button onclick="pauseGame()">Pause</button>
            <button onclick="endGame()">Finish</button>
        </div>
    </div>

    <div id="results-screen" class="screen">
        <h1>Results</h1>
        <div id="stats"></div>
        <div class="buttons">
            <button onclick="replayGame()">Replay</button>
            <button onclick="newWords()">New Words</button>
        </div>
    </div>

    <script>
        // JavaScript
        let wordList = [];
        let gamePairs = [];
        let selectedCards = [];
        let correctCount = 0;
        let incorrectCount = 0;
        let timer;
        const TIME_LIMIT = 120; // 2 minutes default

        // Preset Lists
        const presets = {
            beginner: [
                { english: "cat", swedish: "katt" },
                { english: "dog", swedish: "hund" },
                { english: "house", swedish: "hus" },
                { english: "car", swedish: "bil" },
                { english: "apple", swedish: "äpple" },
                { english: "book", swedish: "bok" }
            ],
            intermediate: [
                { english: "friend", swedish: "vän" },
                { english: "school", swedish: "skola" },
                { english: "family", swedish: "familj" },
                { english: "street", swedish: "gata" },
                { english: "summer", swedish: "sommar" },
                { english: "winter", swedish: "vinter" }
            ]
        };

        // Initialize Input Screen
        function initInputScreen() {
            const grid = document.getElementById('input-grid');
            grid.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                addInputRow(i + 1);
            }
            loadSavedList();
            document.getElementById('presets').addEventListener('change', (e) => {
                if (e.target.value) {
                    wordList = presets[e.target.value];
                    renderInputGrid();
                    saveList();
                }
            });
        }

        function addInputRow(num) {
            const grid = document.getElementById('input-grid');
            const row = document.createElement('div');
            row.innerHTML = `
                <input type="text" placeholder="English" onblur="updateWordList()">
                <input type="text" placeholder="Svenska" onblur="updateWordList()">
            `;
            grid.appendChild(row);
        }

        function addRow() {
            addInputRow(document.querySelectorAll('#input-grid input').length / 2 + 1);
        }

        function updateWordList() {
            const inputs = document.querySelectorAll('#input-grid input');
            wordList = [];
            for (let i = 0; i < inputs.length; i += 2) {
                const english = inputs[i].value.trim();
                const swedish = inputs[i + 1].value.trim();
                if (english && swedish) {
                    wordList.push({ english, swedish });
                }
            }
            saveList();
        }

        function saveList() {
            localStorage.setItem('vocabList', JSON.stringify(wordList));
        }

        function loadSavedList() {
            const saved = localStorage.getItem('vocabList');
            if (saved) {
                wordList = JSON.parse(saved);
                renderInputGrid();
            }
        }

        function exportList() {
            const text = wordList.map(pair => `${pair.english}\t${pair.swedish}`).join('\n');
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'vocab_list.txt';
            a.click();
        }

        function renderInputGrid() {
            const grid = document.getElementById('input-grid');
            grid.innerHTML = '';
            wordList.forEach((pair, i) => {
                const row = document.createElement('div');
                row.innerHTML = `
                    <input type="text" value="${pair.english}" onblur="updateWordList()">
                    <input type="text" value="${pair.swedish}" onblur="updateWordList()">
                `;
                grid.appendChild(row);
            });
            if (wordList.length < 10) {
                for (let i = wordList.length; i < 10; i++) {
                    addInputRow(i + 1);
                }
            }
        }

        // Game Logic
        function startGame() {
            updateWordList();
            if (wordList.length < 6) {
                document.getElementById('error-msg').textContent = 'Add at least 6 pairs to start!';
                return;
            }
            switchScreen('game-screen');
            gamePairs = [...wordList];
            correctCount = 0;
            incorrectCount = 0;
            setupGame();
            startTimer();
        }

        function setupGame() {
            const grid = document.getElementById('game-grid');
            grid.innerHTML = '';
            const shuffledEnglish = shuffle([...gamePairs]).slice(0, 4);
            const shuffledSwedish = shuffle([...gamePairs]).slice(0, 4);
            shuffledEnglish.forEach(pair => {
                const card = createCard(pair.english, 'english');
                grid.appendChild(card);
            });
            shuffledSwedish.forEach(pair => {
                const card = createCard(pair.swedish, 'swedish');
                grid.appendChild(card);
            });
            updateProgress();
        }

        function createCard(text, type) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.textContent = text;
            card.dataset.type = type;
            card.dataset.text = text;
            card.addEventListener('click', () => selectCard(card));
            return card;
        }

        function selectCard(card) {
            if (selectedCards.length >= 2 || card.classList.contains('selected')) return;
            card.classList.add('selected');
            selectedCards.push(card);
            if (selectedCards.length === 2) {
                checkMatch();
            }
        }

        function checkMatch() {
            const [card1, card2] = selectedCards;
            const pair1 = gamePairs.find(p => p.english === card1.dataset.text || p.swedish === card1.dataset.text);
            const pair2 = gamePairs.find(p => p.english === card2.dataset.text || p.swedish === card2.dataset.text);
            if (pair1 === pair2 && card1.dataset.type !== card2.dataset.type) {
                card1.classList.add('correct');
                card2.classList.add('correct');
                correctCount++;
                setTimeout(() => replaceCards(card1, card2), 500);
            } else {
                card1.classList.add('incorrect');
                card2.classList.add('incorrect');
                incorrectCount++;
                setTimeout(() => {
                    card1.classList.remove('incorrect', 'selected');
                    card2.classList.remove('incorrect', 'selected');
                    selectedCards = [];
                }, 300);
            }
            updateProgress();
        }

        function replaceCards(card1, card2) {
            const grid = document.getElementById('game-grid');
            const newPair = shuffle([...gamePairs])[0];
            const newCard1 = createCard(newPair.english, 'english');
            const newCard2 = createCard(newPair.swedish, 'swedish');
            grid.replaceChild(newCard1, card1);
            grid.replaceChild(newCard2, card2);
            selectedCards = [];
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function updateProgress() {
            document.getElementById('progress').textContent = `Pairs Matched: ${correctCount} | Incorrect: ${incorrectCount} | Time Left: ${Math.max(0, TIME_LIMIT - Math.floor((Date.now() - startTime) / 1000))}s`;
        }

        let startTime;
        function startTimer() {
            startTime = Date.now();
            timer = setInterval(() => {
                updateProgress();
                if (Date.now() - startTime >= TIME_LIMIT * 1000) {
                    endGame();
                }
            }, 1000);
        }

        function pauseGame() {
            clearInterval(timer);
            alert('Game Paused\n' + document.getElementById('progress').textContent);
            startTimer();
        }

        function endGame() {
            clearInterval(timer);
            switchScreen('results-screen');
            document.getElementById('stats').innerHTML = `
                Correct: ${correctCount}<br>
                Incorrect: ${incorrectCount}<br>
                Score: ${correctCount * 10 - incorrectCount * 5}
            `;
        }

        // Navigation
        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function replayGame() {
            switchScreen('game-screen');
            setupGame();
            startTimer();
        }

        function newWords() {
            switchScreen('input-screen');
            initInputScreen();
        }

        // Start the app
        initInputScreen();
    </script>
</body>
</html>